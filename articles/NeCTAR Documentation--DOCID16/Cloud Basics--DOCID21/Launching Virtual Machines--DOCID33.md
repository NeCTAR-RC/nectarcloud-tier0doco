# Launching Virtual Machines

This guide describes launching a running instance (virtual machine) with SSH login
enabled.

## Preparation

You need to create a public/private key pair before you can use SSH to login to 
the newly created instance. The public key will be inserted into the instance and
the private key is used on your desktop/laptop.

### Windows User

Use PuTTYgen key generator to generate the required key pair.

- Download PuTTYgen (puttygen.exe) from [PuTTYgen download page][putty]

- Launch the PuTTYgen application by double clicking the puttygen.exe

- The default settings are fine for this case, click the 'Generate' button

- Save your public key by clicking 'Save public key' button. You should give a
 name that will help identify the key in the future

- Save your private key by clicking 'Save private key' button. You should give
 a sensible name for future reference. The passphrase can provide additional
 security, though can be left empty

### Linux/Mac User

Type ssh-keygen in the terminal and enter. This generates a public key (id_rsa.pub)
and a private key (id_rsa). By default, the two keys are located in ~/.ssh

### Import Public Key

The public key generated by Windows/Linux/Mac are required to be imported into
the Nectar Cloud dashboard before use.

- Log into the [Cloud Dashboard][dashboard]

- Go to the Access and Security tab and then to the Keypairs page

- Click 'Import Key Pair' button

- Type in a keypair name and paste the contents of the public key. For Windows
 users, open PuTTYgen and click 'Load' button to load the related private key and
 copy/paste the public key contents. For Linux/Mac user, type
 cat ~/.ssh/id_rsa.pub and copy/paste the public key contents from the terminal
 output

### Nectar Cloud Dashboard

Key pairs can also be created directly through the Nectar Cloud Dashboard.

- Login to the [Cloud Dashboard][dashboard]

- Go to the Access and Security tab and then to the Keypairs page

- Click the 'Create Key Pair' button

- Type in a keypair name in the popup window and click the 'Create Key Pair'
 button

- Save the private key into a directory

Notes: If you are running a Windows machine the SSH private key will need to be
converted (use PuTTYgen for converting keys)

- Open PuTTYgen

- Click 'Load' button to load the private key generated by the Cloud Dashboard

- Click 'Export OpenSSH key' from 'Conversions' menu

- Type a private key name and save

## Select an Image

You need to select an image to be used for your instance. The image defines what
operating system the instance uses and thus you need to select an image based on
your needs. Nectar Cloud offers a list of official images and for
simplicity, these images are recommended. You can find a complete list of
official images from [Nectar image catalog][image]. You can also find all
available images from the [Cloud Dashboard][dashboard].

- Login to the [Cloud Dashboard][dashboard]

- Go to the Dashboard Images tab

For advanced users, you can also create your own images. Please refer to
the [openstack documentation][openstack image] for more details.

## Configure Instance

Before you can launch an instance, you need to configure the below options:

### Details

- Instance Name: the name used by the dashboard to identify the instance

- Flavour: the resources available for the instance. It specifies the number of
 VCPUs, size of root disk, size of ephemeral disk and size of RAM.
 Your allocated flavour or lesser configurations can be selected (the
 default is m2.tiny; a 1 VCPU machine)

- Instance Count: number of instance to launch (the default is 1)

- Instance Boot Source: the media used to boot the instance. You can boot from
 image, snapshot and volume (the default is boot from image)

  - Boot from image: Boot instance using an image

  - Boot from snapshot: Boot instance using a snapshot

  - Boot from volume: Boot instance from volume storage

- Image Name: the name of an Image. This option is used when the Instance Boot
 Source is 'Boot from image'

#### Access & Security

- Key Pair: the public/private keys used to log into the instance. See above to
 see how to create them. This can't be added or changed after the instance is
 created.

- Security Groups: add network access to your instances. This determines what
 services can be accessed on the instance. You must select 'SSH' Security Groups
 to allow you to login via SSH. If 'SSH' Security Groups is not available, you
 can create it by going to Access & Security tab on the right hand side of the
 Cloud Dashboard. The default Security Group (no network access at first) is
 pre-selected

To create a Security Group:

- Login to the [Cloud Dashboard][dashboard]

- Go to the Access & Security tab

- Click 'Create Security Group' button

- Give a name for the Security Group

- Give a meaningful description for the Security Group

- Click 'Create Security Group' button

The newly created Security Group has no rules added (no network access defined).
To add rules to a Security Group:

- Go to the Access & Security tab

- Tick to select the Security Group to add rules

- Click 'Manage Rules' button

- Click 'Add Rule' button

- Select what type of Rule you want to create

- Select from 'Open Port' the 'Port' option to open one single port, or 'Port Range'
 to open a range of ports

- The 'Remote' option specifies the source of the traffic to be allowed via this
 rule. You may do so either in the form of an IP address block (CIDR) or via a
 source group (Security Group).

- Click 'Add' button

You can also click 'Delete Rule' button to delete a rule

### Availability Zone

Select the Availability Zone for your instance. The Availability Zone is the
location for your instance. By default, the system will select an available
location for you. You can also click the 'Advanced' button to select from a
complete list of available Availability Zones

### Post-Creation

You can execute a customization script after you launch your instance. You can
do any initialization and customization to your instance by using this and it
is executed only once at the first boot of your instance. You can copy/paste
your script by selecting 'Direct Input' or you can upload a script file. The
script can be a shell script or Cloud-init script.

### Advanced Options

You can choose whether you automaticly or manually create the disk partition.
In most cases, you shouldn't change the default.

Notes: The above configuration options can be set in the 'Launch Instance' popup
window. To launch the popup window, you can go to the Instances tab and
click 'Launch Instance' button.

To get more information about the terms used, please refer to
[the glossary][glossary].

## Example Launch of an Instance

- Login to the [Cloud Dashboard][dashboard]

- Go to Dashboard Instances tab

- Click 'Launch Instance' button

- Type instance name

- Select a flavour. Flavour indicates the specification of a instance. You can
 find more information in the Flavour Details.

- Select an NeCTAR offical image (we suggest selecting an Ubuntu image such as
 NeCTAR Ubuntu 14.10 (Utopic) amd64)

- Click Access & Security tab

- Select a key pair created earlier

- Select security groups to use. Tick 'ssh' and 'http' (these are pre-defined
 groups in the default personal project)

- Click Availability Zone

- Select the location of your instance or leave as unselected (the system will
 auto select available location)

- Click launch button and the page will change to the Instances Tab

- After a while (usually a couple of minutes), your instance will become active
 and will have an IP address. The IP address is available in the Instances table

The launch button begins Cloud provisioning and initialisation of a running
instance from the selected image and your configuration options. The instance
will normally pass from status "Build" to "Active". Depending on your image
size and cloud activity, the length of time required may vary. Your instance
will have a public IP address and be reachable according to the
Security Groups selected.

You can connect to your new instance via
[Accessing Your Instance][accessing your instance]

## If Launch is Unsuccessful

You may get a message that your quota has been exceeded or you have
insufficient resources. Check the table to the right on the Launch Instance page
for the number of instances you may run simultaneously, then check the
Instances tab to see how many Instances you already have running. You may have
to terminate a running Instance to free resources before you can launch another
(see Instance tab to Terminate). If you need more resources see the allocation
tab to apply for an increase.

If the above doesn't apply to you, alternatively, you can send an email to the
Cloud Help Desk. Please find how to lodge a support ticket from
[Nectar Support][nectar support].

[dashboard]: https://dashboard.rc.nectar.org.au
[putty]: http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html
[image]: https://wiki.rc.nectar.org.au/wiki/Image_Catalog
[openstack image]: http://docs.openstack.org/image-guide/content/ch_creating_images_manually.html
[accessing your instance]: http://bla.bla.bla
[nectar support]: https://support.rc.nectar.org.au/docs/support
[glossary]: http://bla.bla.bla
